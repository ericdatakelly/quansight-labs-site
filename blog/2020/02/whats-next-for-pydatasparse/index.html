<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Planned architectural work for PyData/Sparse | Quansight Labs</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">
<link rel="canonical" href="https://labs.quansight.org/blog/2020/02/whats-next-for-pydatasparse/">
<link rel="icon" href="../../../../favicon.ico" sizes="16x16">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
   tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"], ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
   },
   displayAlign: 'center', // Change this to 'center' to center equations.
   "HTML-CSS": {
       styles: {'.MathJax_Display': {"margin": 0}}
   }
});
</script><!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163785882-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163785882-1');
</script><link rel="stylesheet" type="text/css" href="../../../../assets/css/tipuesearch.css">
<meta name="author" content="Hameer Abbasi">
<meta property="description" content="What have we been doing so far? ü§î
Research üìö
A lot of behind the scenes work has been taking place on PyData/Sparse. Not so much in terms of code, more in terms of research and community/team building">
<link rel="prev" href="../my-unexpected-dive-into-open-source-python/" title="My Unexpected Dive into Open-Source Python" type="text/html">
<link rel="next" href="../../03/uarray-gsoc-participation/" title="uarray: GSoC Participation" type="text/html">
<meta property="og:site_name" content="Quansight Labs">
<meta property="og:title" content="Planned architectural work for PyData/Sparse">
<meta property="og:url" content="https://labs.quansight.org/blog/2020/02/whats-next-for-pydatasparse/">
<meta property="og:description" content="What have we been doing so far? ü§î
Research üìö
A lot of behind the scenes work has been taking place on PyData/Sparse. Not so much in terms of code, more in terms of research and community/team building">
<meta property="og:image" content="https://labs.quansight.org/images/QuansightLabs_logo_V2.png">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-03-11T12:30:00+01:00">
<meta property="article:tag" content="Big data">
<meta property="article:tag" content="NumPy">
<meta property="article:tag" content="SciPy">
<meta property="article:tag" content="Sparse">
<meta property="article:tag" content="Tensors">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@quansightai">
<meta property="twitter:image" content="https://labs.quansight.org/images/QuansightLabs_logo_V2.png">
<link rel="stylesheet" href="../../../../assets/css/quansightlabs.css">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://labs.quansight.org/">
            <img src="../../../../images/QuansightLabs_logo_V1_white.png" alt="Quansight Labs" id="logo" class="d-inline-block align-top"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../../../" class="nav-link">Home</a>
                </li>
<li class="nav-item">
<a href="../../../" class="nav-link">Blog</a>
                </li>
<li class="nav-item">
<a href="../../../../team/" class="nav-link">Team</a>
                </li>
<li class="nav-item">
<a href="../../../../projects/" class="nav-link">Projects</a>
                </li>
<li class="nav-item">
<a href="../../../../about/" class="nav-link">About</a>
                </li>
<li class="nav-item">
<a href="../../../../rss.xml" class="nav-link">RSS</a>

                
            </li>
</ul>
<form class="navbar-form navbar-left" action="../../../../search" role="search">
    <div class="form-group">
        <input type="text" class="form-control" id="tipue_search_input" name="q" placeholder="Search‚Ä¶" autocomplete="off">
</div>
    <input type="submit" value="Local Search" style="visibility: hidden;"><!-- button type="submit" class="btn btn-default">Submit</button -->
</form>


            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name">
                <a href="." class="u-url">Planned architectural work for PyData/Sparse</a>
            </h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../../../authors/hameer-abbasi/">Hameer Abbasi</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2020-03-11T12:30:00+01:00" itemprop="datePublished" title="2020-03-11">2020-03-11</time></a>
            </p>
            

        </div>
        
        <ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../categories/big-data/" rel="tag">Big data</a></li>
            <li><a class="tag p-category" href="../../../../categories/numpy/" rel="tag">NumPy</a></li>
            <li><a class="tag p-category" href="../../../../categories/scipy/" rel="tag">SciPy</a></li>
            <li><a class="tag p-category" href="../../../../categories/sparse/" rel="tag">Sparse</a></li>
            <li><a class="tag p-category" href="../../../../categories/tensors/" rel="tag">Tensors</a></li>
        </ul></header><div class="e-content entry-content" itemprop="articleBody text">
        <div>
<h2>What have we been doing so far? ü§î</h2>
<h3>Research üìö</h3>
<p>A lot of behind the scenes work has been taking place on PyData/Sparse. Not so much in terms of code, more in terms of research and community/team building. I've more-or-less decided to use the structure and the research behind the <a href="https://github.com/tensor-compiler/taco">Tensor Algebra Compiler</a>, the work of Fredrik Kjolstad and his collaborators at MIT. üôáüèª‚Äç‚ôÇÔ∏è To this end, I've read/watched the following talks and papers:</p>
<!-- TEASER_END -->

<ul>
<li>Fredrik Kjolstad, Shoaib Kamil, Stephen Chou, David Lugato, and Saman Amarasinghe. 2017. The tensor algebra compiler. Proc. ACM Program. Lang. 1, OOPSLA, Article 77 (October 2017), 29 pages. DOI:<a href="https://doi.org/10.1145/3133901">https://doi.org/10.1145/3133901</a>
</li>
<li>Fredrik Kjolstad, Peter Ahrens, Shoaib Kamil, and Saman Amarasinghe. 2018. Sparse Tensor Algebra Optimizations with Workspaces. <a href="https://arxiv.org/abs/1802.10574">https://arxiv.org/abs/1802.10574</a>
</li>
<li>Chou, Stephen, Fredrik Kjolstad, and Saman Amarasinghe. ‚ÄúFormat Abstraction for Sparse Tensor Algebra Compilers.‚Äù Proceedings of the ACM on Programming Languages 2.OOPSLA (2018): 1‚Äì30. Crossref. Web. <a href="https://arxiv.org/abs/1804.10112">https://arxiv.org/abs/1804.10112</a>
</li>
<li>Ryan Senanayake, Fredrik Kjolstad, Changwan Hong, Shoaib Kamil, and Saman Amarasinghe. 2019. A Unified Iteration Space Transformation Framework for Sparse and Dense Tensor Algebra <a href="https://arxiv.org/abs/2001.00532">https://arxiv.org/abs/2001.00532</a>
</li>
<li>Stephen Chou, Fredrik Kjolstad, Saman Amarasinghe. Automatic Generation of Efficient Sparse Tensor Format Conversion Routines. 2019. Automatic Generation of Efficient Sparse Tensor Format Conversion Routines <a href="https://arxiv.org/abs/2001.02609">https://arxiv.org/abs/2001.02609</a>
</li>
<li>The Sparse Tensor Algebra Compiler <a href="https://www.youtube.com/watch?v=0OP8WjFyU-Q">https://www.youtube.com/watch?v=0OP8WjFyU-Q</a>
</li>
<li>Format Abstraction for Sparse Tensor Algebra Compilers <a href="https://www.youtube.com/watch?v=sQOq3Ci4tB0">https://www.youtube.com/watch?v=sQOq3Ci4tB0</a>
</li>
<li>The Tensor Algebra Compiler <a href="https://www.youtube.com/watch?v=yAtG64qV2nM">https://www.youtube.com/watch?v=yAtG64qV2nM</a>
</li>
</ul>
<p>A bit heavy, so don't feel obliged to go through them. üòâ</p>
<h3>Resources üë•</h3>
<p>I've also had conversations with Ralf Gommers about getting someone experienced in Computer Science on board, as a lot of this work is very heavy on Computer Science.</p>
<h3>Strategy ü¶æ</h3>
<p>The original TACO compiler requires a compiler at runtime, which isn't ideal for many users. However, what's nice is that we have Numba as a Python package. One, instead of emitting C code, can emit Python AST to be transpiled to LLVM by Numba, and then to machine code. I settled on this after researching Cppyy, which also requires a compiler, and pybind11, which wouldn't work as TACO itself is built to require a compiler.</p>
<p>The above warrants some explanation as to <em>why</em> exactly we're following this pattern. See, TACO is based on the fact that many popular matrix formats can be created using just a few per-dimension formats. The advantage behind this is that one can create highly efficient
code from just a few building blocks (albeit some hard-to-understand ones) for a lot of different formats. The downside is, one needs to do some code generation (the original TACO emits C code). In Python-land, one could emit source code or AST, with the latter being easier to debug and with guaranteed syntatical correctness. This is the reason I decided to go with AST.</p>
<h2>API Changes üë®üèª‚Äçüíª</h2>
<p>I'd also like to invite anyone who's interested into the discussion about API changes. The discussion can be found in <a href="https://github.com/pydata/sparse/issues/326">this issue</a>, but essentially, <del>we're planning on moving to a lazy model for an asymptotically better runtime performance</del>. We decided not to go and break backwards compatibility and essentially decided to have a separate submodule for this kind of work, then calling <code>.compute()</code> similar to Dask at the end.</p>
<h2>So what does this mean for the user? üòï</h2>
<p>Why, support for a lot more operations across a lot more formats, really. üòÑ And don't forget the performance. üöÄ With the downside being lazy operations a-la Dask.</p>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../my-unexpected-dive-into-open-source-python/" rel="prev" title="My Unexpected Dive into Open-Source Python">Previous post</a>
            </li>

            <li class="archive">
                <a href="../../../../archive.html" rel="archive" title="Archive ">Archive</a>
            </li>

            <li class="next">
                <a href="../../03/uarray-gsoc-participation/" rel="next" title="uarray: GSoC Participation">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content--><footer id="footer">
            Contents ¬© 2021         <a href="../../../../team">Quansight Labs Team</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="../../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
